<!doctype html>

<meta charset="utf-8" />
<meta name='google-site-verification' content='-jE-f4Gbpim9_feo74iK5zP_-tegU7xvV89-yqFy7ZI' />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="description" content="The next step for Bernie Sanders' movement is a new group called Our Revolution, which will fight to transform America and advance the progressive agenda that we believe in. Get started by hosting an event today and let's continue this political revolution.">
<meta name="keywords" content="Bernie Sanders, FeelTheBern, Events, Bernie, #bernie2016, #feelthebern, #westandtogether">
<meta property="og:image" content="http://map.ourrevolution.com/img/phonebank.png" />
<meta property="og:url" content="http://map.ourrevolution.com/" />
<meta property="og:title" content="Let's Organize and Continue this Political Revolution"/>
<meta property="og:description" content="The next step for Bernie Sanders' movement is a new group called Our Revolution, which will fight to transform America and advance the progressive agenda that we believe in. Get started by hosting an event today and let's continue this political revolution."/>
<link href='//api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.css' rel='stylesheet' />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@OurRevolution">
<meta name="twitter:creator" content="@OurRevolution">
<meta name="twitter:title" content="Let's Organize and Continue this Political Revolution">
<meta name="twitter:description" content="The next step for Bernie Sanders' movement is a new group called Our Revolution, which will fight to transform America and advance the progressive agenda that we believe in. Get started by hosting an event today and let's continue this political revolution.">
<meta name="twitter:image" content="http://d1y0otadi3knf6.cloudfront.net/img/phonebank.png">

<link rel="stylesheet" type="text/css" href="./css/events-map.css">
<link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css?family=Merriweather:400,900,700' />
<link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css?family=Lato:100,900,700,400,300' />
<title>Let's Get to Work! Find Volunteer Work, Grassroots events, and official Rallies for Our Revolution.</title>
<!--[if lte IE 9]>
       <meta http-equiv="refresh" content="0; url=https://go.ourrevolution.com/page/event/search_simple" />
     <![endif]-->
<body class='list-view'>
<section id='header'>
<div id="header" class='lato'>
  <div class="main-title-area">
    <div style="margin-bottom: 4px;">
      <div id='spiel'>
        <strong>Phonebank for Our Revolution!</strong><br>
        Find the nearest phonebank party near you.
      </div>
    </div>
  </div>

  <nav>
    <ul id="nav">
      <li>
        <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://map.ourrevolution.com/phonebank/" data-text="I'm going to a phonebank party for Our Revolution! Find events near you!" data-related="BernieSanders" data-count="none">Tweet</a>
        <div class="fb-share-button" data-href="http://map.ourrevolution.com/phonebank/" data-layout="button"></div>
      </li>
      <li><a href="https://go.ourrevolution.com/page/event/create" class="contribute contribute-big" target="_blank">Host an Event</a></li>
    </ul>
  </nav>
  <div style="clear: both"></div>
</div>
</section>
<section id='activity-area' class='clearfix'>
  <article id='events'>
    <div id='filters'>
      <div id='loading-icon' class='lato'>Loading...</div>
      <h3 id='switch-link'>
        <a href='javascript: void(null)' onclick='window.mapManager.toMapView()' id='to-map-view'>Show Map</a>
        <a href='javascript: void(null)' onclick='window.mapManager.toListView()' id='to-list-view'>Show List</a>
      </h3>
      <h4 class='lato title'>
        <span id='screen-title'>Filters</span>
        <span id='mobile-title'>Phonebank for Our Revolution</span>
      </h4>
      <form id='filter-form'>
        <table>
          <tr>
            <td>
              <h5 class='lato'>By Zipcode</h5>
              <input type='text' name='zipcode' maxlength='5' placeholder='ZIPCODE' onclick="this.select();" >
            </td>
            <td>
              <h5 class='lato'>Distance</h5>
              <select name='distance'>
                <option value='5'>5mi</option>
                <option value='20'>20mi</option>
                <option value='50' selected='selected'>50mi</option>
                <option value='100'>100mi</option>
              </select>
            </td>
            <td>
              <h5 class='lato'>Sort By</h5>
              <select name='sort'>
                <option value='time' selected='selected'>Time</option>
                <option value='distance'>Distance</option>
              </select>
              <input type='button' style='position: absolute; z-index: -1; opacity: 0;' id='hidden-button'/>
            </td>
          </tr>
        </table>
      </form>
    </div>
    <div id='event-list-container'>
      <ul id='event-list'></ul>
      <footer>
        <div id='footer-area' >
          <h5>Our Revolution</h5>
          <h5>PO Box 66208</h5>
          <h5>Washington, DC 20035</h5>

          <div id='paid-for-bernie-box'>
            Paid for By Our Revolution
          </div>
          <div id='footer-billionaire' style="margin-bottom: 30px;">
            <svg width="200" height="40">
                <image xlink:href="//d1y0otadi3knf6.cloudfront.net/img/billionaires.svg" width="200" height="40"
                  x="0"
                />
            </svg>
          </div>

          <sub>&copy; Our Revolution | <a href='https://ourrevolution.com/privacy-policy/'>Privacy Policy</a></sub>
        </div>

      </footer>
    </div>
  </article>
  <article id='map'></article>
</section>

<script src='//d1y0otadi3knf6.cloudfront.net/js/d3.gz' type='text/javascript'></script>
<script id='zipcodes-datadump' type='text/plain'></script>
<script src="//d1y0otadi3knf6.cloudfront.net/js/jquery.gz"></script>
<script src='//d1y0otadi3knf6.cloudfront.net/js/deparam.min.gz'></script>
<script src='//d1y0otadi3knf6.cloudfront.net/js/mapbox.gz'></script>
<!-- <script src='/js/leaflet-bouncer.js'></script> -->
<script src='./js/moment.min.js'></script>
<script src='./js/MapManager.js'></script>
<script type='text/javascript'>
(function($, d3) {
$("#loading-icon").show();
$.ajax({
  url: '//d1y0otadi3knf6.cloudfront.net/js/event-data.gz',
  dataType: 'script',
  cache: true, // otherwise will get fresh copy every page load
  success: function(data) {

    //Load zipcodes
    //d1y0otadi3knf6.cloudfront.net
    d3.csv('//aufstehen.io/d/us_postal_codes.gz',
     function(zipcodes) {

      window.mapManager = MapManager(
          window.EVENT_DATA.results.filter(function(d){ return d.event_type_name == 'Phone Bank'; }),
          zipcodes);

      $(window).trigger("hashchange");
    });
  }, error: function(a,b,c) {
    console.log("ERROR", b,c);
  }
});


 /** initial loading before activating listeners...
  */

 var params = $.deparam(window.location.hash.substring(1));
  if (params.zipcode) { $("input[name='zipcode']").val(params.zipcode); }
  if (params.distance) { $("select[name='distance']").val(params.distance);}
  if (params.sort) { $("select[name='sort']").val(params.sort);}



/***
 *  define events
 */
 //only numbers
 $("input[name='zipcode']").on('keyup keydown', function(e) {
  if (e.type == 'keydown' && (e.keyCode < 48 || e.keyCode > 57)
      && e.keyCode != 8 && !(e.keyCode >= 37 || e.keyCode <= 40)) {
    return false;
  }

  if (e.type == 'keyup' && $(this).val().length == 5) {
    if (! (e.keyCode >= 37 && e.keyCode <= 40) ) {
      $(this).closest("form#filter-form").submit();
      $("#hidden-button").focus();
    }
  }
 });

 /***
  *  onchange of select
  */
  $("select[name='distance'],select[name='sort']").on('change', function(e) {
    $(this).closest("form#filter-form").submit();
  });

 //On submit
 $("form#filter-form").on('submit', function(e) {
  var serial = $(this).serialize();
  window.location.hash = serial;
  e.preventDefault();
  return false;
 });

 $(window).on('hashchange', function(e) {
  var hash = window.location.hash;
  if (hash.length == 0 || hash.substring(1) == 0) { $("#loading-icon").hide(); return false; }

  var params = $.deparam(hash.substring(1));

  $("#loading-icon").show();
  setTimeout(function() {
    window.mapManager.filter(params.zipcode, params.distance, params.sort);
    $("#loading-icon").hide();
  }, 50);
  // $("#loading-icon").hide();
 });


})(jQuery, d3);
</script>

<!-- SOCIAL -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80816425-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        // appId      : '1465128650469416',
        appId      : '1619513324978096',
        xfbml      : true,
        version    : 'v2.3'
      });
    };

    (function(d, s, id){
       var js, fjs = d.getElementsByTagName(s)[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement(s); js.id = id;
       js.src = "//connect.facebook.net/en_US/sdk.js";
       fjs.parentNode.insertBefore(js, fjs);
     }(document, 'script', 'facebook-jssdk'));
  </script>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</body>
